# Copyright 2025 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

Object:
  apiVersion: certificatemanager.cnrm.cloud.google.com/v1beta1
  kind: CertificateManagerCertificate
  metadata:
    annotations:
      cnrm.cloud.google.com/management-conflict-prevention-policy: none
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"certificatemanager.cnrm.cloud.google.com/v1beta1","kind":"CertificateManagerCertificate","metadata":{"annotations":{},"name":"mcraig-test-cas-cert","namespace":"platform-kcc-apps-platdev-99bb42"},"spec":{"description":"mcraig sample managed certificate for kcc","location":"global","managed":{"domains":["*.cloudnetworks.x.gcpnp.anz","test.clludnetworks.x.gcpnp.anz"],"issuanceConfigRef":{"external":"projects/anz-x-apps-platdev-99bb42/locations/global/certificateIssuanceConfigs/test-rotation"}},"projectRef":{"external":"anz-x-apps-platdev-99bb42"},"resourceID":"kcc-test-cas-cert","scope":"ALL_REGIONS"}}
    creationTimestamp: "2025-05-26T04:26:28Z"
    deletionGracePeriodSeconds: 0
    deletionTimestamp: "2025-05-26T04:26:59Z"
    finalizers:
    - cnrm.cloud.google.com/finalizer
    generation: 2
    labels:
      ci_group: platform
      x.anz.com/asset: platform
    managedFields:
    - apiVersion: certificatemanager.cnrm.cloud.google.com/v1beta1
      fieldsType: FieldsV1
      fieldsV1:
        f:metadata:
          f:annotations:
            .: {}
            f:kubectl.kubernetes.io/last-applied-configuration: {}
        f:spec:
          .: {}
          f:description: {}
          f:location: {}
          f:managed:
            .: {}
            f:domains: {}
            f:issuanceConfigRef:
              .: {}
              f:external: {}
          f:projectRef:
            .: {}
            f:external: {}
          f:resourceID: {}
          f:scope: {}
      manager: kubectl-client-side-apply
      operation: Update
      time: "2025-05-26T04:26:28Z"
    - apiVersion: certificatemanager.cnrm.cloud.google.com/v1beta1
      fieldsType: FieldsV1
      fieldsV1:
        f:metadata:
          f:finalizers:
            .: {}
            v:"cnrm.cloud.google.com/finalizer": {}
      manager: cnrm-controller-manager
      operation: Update
      time: "2025-05-26T04:26:29Z"
    - apiVersion: certificatemanager.cnrm.cloud.google.com/v1beta1
      fieldsType: FieldsV1
      fieldsV1:
        f:metadata:
          f:annotations:
            f:cnrm.cloud.google.com/state-into-spec: {}
        f:status:
          .: {}
          f:conditions: {}
          f:observedGeneration: {}
      manager: cnrm-controller-manager
      operation: Update
      subresource: status
      time: "2025-05-30T00:20:05Z"
    name: mcraig-test-cas-cert
    namespace: platform-kcc-apps-platdev-99bb42
    resourceVersion: "1893656910"
    uid: 54a495fb-9b1c-4ab0-bed9-b28ed10c00a7
  spec:
    description: mcraig sample managed certificate for kcc
    location: global
    managed:
      domains:
      - '*.cloudnetworks.x.gcpnp.anz'
      - test.clludnetworks.x.gcpnp.anz
      issuanceConfigRef:
        external: projects/anz-x-apps-platdev-99bb42/locations/global/certificateIssuanceConfigs/test-rotation
    projectRef:
      external: anz-x-apps-platdev-99bb42
    resourceID: kcc-test-cas-cert
    scope: ALL_REGIONS
  status:
    conditions:
    - lastTransitionTime: "2025-05-26T04:26:29Z"
      message: |-
        Delete call failed: error deleting resource: [{0 Error when reading or editing Certificate: googleapi: Error 400: can't delete certificate that is referenced by a CertificateMapEntry or other resources
        Details:
        [
          {
            "@type": "type.googleapis.com/google.rpc.PreconditionFailure",
            "violations": [
              {
                "description": "can't delete certificate that is referenced by a CertificateMapEntry or other resources",
                "subject": "projects/949316254914/locations/global/certificates/kcc-test-cas-cert",
                "type": "RESOURCE_STILL_IN_USE"
              }
            ]
          }
        ]  []}]
      reason: DeleteFailed
      status: "False"
      type: Ready
    observedGeneration: 2
