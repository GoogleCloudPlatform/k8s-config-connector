# Copyright 2025 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

Object:
  apiVersion: certificatemanager.cnrm.cloud.google.com/v1beta1
  kind: CertificateManagerCertificate
  metadata:
    annotations:
      cnrm.cloud.google.com/management-conflict-prevention-policy: none
      cnrm.cloud.google.com/observed-secret-versions: '{"lib-mr-cert-secret":"1737260464"}'
      cnrm.cloud.google.com/state-into-spec: absent
      kubectl.kubernetes.io/last-applied-configuration: |
        {"apiVersion":"certificatemanager.cnrm.cloud.google.com/v1beta1","kind":"CertificateManagerCertificate","metadata":{"annotations":{},"labels":{"ci_group":"platform"},"name":"ilb-mul-region-cm-cert","namespace":"platform-kcc-apps-platdev-99bb42"},"spec":{"description":"self managed Certificate Manager certificate for ilb multi region","location":"global","scope":"ALL_REGIONS","selfManaged":{"pemCertificate":"-----BEGIN CERTIFICATE-----\nMIIFyzCCA7OgAwIBAgIUAKi3/asKTCTUNRX3uc51EDMJVXQwDQYJKoZIhvcNAQEN\nBQAwgYExCzAJBgNVBAYTAkFVMQwwCgYDVQQIEwNWSUMxEjAQBgNVBAcTCU1lbGJv\ndXJuZTEMMAoGA1UEChMDYW56MQwwCgYDVQQLEwNnY3AxITAfBgNVBAMTGEFOWiBH \n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIHMjCCBRqgAwIBAgITJOQwtmGhCxUp1j+CECjUMKk3TjANBgkqhkiG9w0BAQ0F\nADBqMRMwEQYKCZImiZPyLGQBGRYDY29tMRMwEQYKCZImiZPyLGQBGRYDYW56MRow\nGAYKCZImiZPyLGQBGRYKZ2xvYmFsdGVzdDEiMCAGA1UEAxMZQU5aIEdsb2JhbFRl\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIG+TCCBOGgAwIBAgITHgAAABB9pZ7emGUq/QAAAAAAEDANBgkqhkiG9w0BAQsF\nNDNaMG4xCzAJBgNVBAYTAkFVMQwwCgYDVQQIEwNWSUMxEjAQBgNVBAcTCU1lbGJv\ndXJuZTEMMAoGA1UEChMDYW56MQwwCgYDVQQLEwNnY3AxITAfBgNVBAMTGEFOWiBH\n-----END CERTIFICATE-----","pemPrivateKey":{"valueFrom":{"secretKeyRef":{"key":"tls.key","name":"lib-mr-cert-secret"}}}}}}
    creationTimestamp: "2025-03-05T22:22:14Z"
    finalizers:
    - cnrm.cloud.google.com/finalizer
    - cnrm.cloud.google.com/deletion-defender
    generation: 2
    labels:
      ci_group: platform
      x.anz.com/asset: platform
    managedFields:
    - apiVersion: certificatemanager.cnrm.cloud.google.com/v1beta1
      fieldsType: FieldsV1
      fieldsV1:
        f:metadata:
          f:annotations:
            .: {}
            f:kubectl.kubernetes.io/last-applied-configuration: {}
          f:labels:
            .: {}
            f:ci_group: {}
        f:spec:
          .: {}
          f:description: {}
          f:location: {}
          f:scope: {}
          f:selfManaged:
            .: {}
            f:pemCertificate: {}
            f:pemPrivateKey:
              .: {}
              f:valueFrom:
                .: {}
                f:secretKeyRef:
                  .: {}
                  f:key: {}
                  f:name: {}
      manager: kubectl-client-side-apply
      operation: Update
      time: "2025-03-05T22:22:14Z"
    - apiVersion: certificatemanager.cnrm.cloud.google.com/v1beta1
      fieldsType: FieldsV1
      fieldsV1:
        f:metadata:
          f:annotations:
            f:cnrm.cloud.google.com/observed-secret-versions: {}
            f:cnrm.cloud.google.com/state-into-spec: {}
          f:finalizers:
            .: {}
            v:"cnrm.cloud.google.com/deletion-defender": {}
            v:"cnrm.cloud.google.com/finalizer": {}
        f:spec:
          f:resourceID: {}
      manager: cnrm-controller-manager
      operation: Update
      time: "2025-03-05T22:22:18Z"
    - apiVersion: certificatemanager.cnrm.cloud.google.com/v1beta1
      fieldsType: FieldsV1
      fieldsV1:
        f:status:
          .: {}
          f:conditions: {}
          f:observedGeneration: {}
      manager: cnrm-controller-manager
      operation: Update
      subresource: status
      time: "2025-05-30T00:20:53Z"
    name: ilb-mul-region-cm-cert
    namespace: platform-kcc-apps-platdev-99bb42
    resourceVersion: "1893658055"
    uid: d673e6c0-20f1-4278-b96e-abcc67167a12
  spec:
    description: self managed Certificate Manager certificate for ilb multi region
    location: global
    projectRef:
      external: anz-x-apps-platdev-99bb42
    resourceID: ilb-mul-region-cm-cert
    scope: ALL_REGIONS
    selfManaged:
      pemCertificate: "-----BEGIN CERTIFICATE-----\nMIIFyzCCA7OgAwIBAgIUAKi3/asKTCTUNRX3uc51EDMJVXQwDQYJKoZIhvcNAQEN\nBQAwgYExCzAJBgNVBAYTAkFVMQwwCgYDVQQIEwNWSUMxEjAQBgNVBAcTCU1lbGJv\ndXJuZTEMMAoGA1UEChMDYW56MQwwCgYDVQQLEwNnY3AxITAfBgNVBAMTGEFOWiBH
        \n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIHMjCCBRqgAwIBAgITJOQwtmGhCxUp1j+CECjUMKk3TjANBgkqhkiG9w0BAQ0F\nADBqMRMwEQYKCZImiZPyLGQBGRYDY29tMRMwEQYKCZImiZPyLGQBGRYDYW56MRow\nGAYKCZImiZPyLGQBGRYKZ2xvYmFsdGVzdDEiMCAGA1UEAxMZQU5aIEdsb2JhbFRl\n-----END
        CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIG+TCCBOGgAwIBAgITHgAAABB9pZ7emGUq/QAAAAAAEDANBgkqhkiG9w0BAQsF\nNDNaMG4xCzAJBgNVBAYTAkFVMQwwCgYDVQQIEwNWSUMxEjAQBgNVBAcTCU1lbGJv\ndXJuZTEMMAoGA1UEChMDYW56MQwwCgYDVQQLEwNnY3AxITAfBgNVBAMTGEFOWiBH\n-----END
        CERTIFICATE-----"
      pemPrivateKey:
        valueFrom:
          secretKeyRef:
            key: tls.key
            name: lib-mr-cert-secret
  status:
    conditions:
    - lastTransitionTime: "2025-03-27T00:25:12Z"
      message: |-
        Update call failed: error applying desired state: summary: Error creating Certificate: googleapi: Error 400: x509: malformed certificate
        Details:
        [
          {
            "@type": "type.googleapis.com/google.rpc.BadRequest",
            "fieldViolations": [
              {
                "description": "x509: malformed certificate",
                "field": "self_managed.pem_certificate"
              }
            ]
          }
        ]
      reason: UpdateFailed
      status: "False"
      type: Ready
    observedGeneration: 2
