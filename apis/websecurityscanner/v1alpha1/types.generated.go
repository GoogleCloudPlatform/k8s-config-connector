// Copyright 2025 Google LLC
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

package v1alpha1


// +kcc:proto=google.cloud.websecurityscanner.v1beta.Finding
type Finding struct {
	// The resource name of the Finding. The name follows the format of
	//  'projects/{projectId}/scanConfigs/{scanConfigId}/scanruns/{scanRunId}/findings/{findingId}'.
	//  The finding IDs are generated by the system.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.Finding.name
	Name *string `json:"name,omitempty"`

	// The type of the Finding.
	//  Detailed and up-to-date information on findings can be found here:
	//  https://cloud.google.com/security-scanner/docs/scan-result-details
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.Finding.finding_type
	FindingType *string `json:"findingType,omitempty"`

	// The http method of the request that triggered the vulnerability, in
	//  uppercase.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.Finding.http_method
	HTTPMethod *string `json:"httpMethod,omitempty"`

	// The URL produced by the server-side fuzzer and used in the request that
	//  triggered the vulnerability.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.Finding.fuzzed_url
	FuzzedURL *string `json:"fuzzedURL,omitempty"`

	// The body of the request that triggered the vulnerability.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.Finding.body
	Body *string `json:"body,omitempty"`

	// The description of the vulnerability.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.Finding.description
	Description *string `json:"description,omitempty"`

	// The URL containing human-readable payload that user can leverage to
	//  reproduce the vulnerability.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.Finding.reproduction_url
	ReproductionURL *string `json:"reproductionURL,omitempty"`

	// If the vulnerability was originated from nested IFrame, the immediate
	//  parent IFrame is reported.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.Finding.frame_url
	FrameURL *string `json:"frameURL,omitempty"`

	// The URL where the browser lands when the vulnerability is detected.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.Finding.final_url
	FinalURL *string `json:"finalURL,omitempty"`

	// The tracking ID uniquely identifies a vulnerability instance across
	//  multiple ScanRuns.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.Finding.tracking_id
	TrackingID *string `json:"trackingID,omitempty"`

	// An addon containing information reported for a vulnerability with an HTML
	//  form, if any.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.Finding.form
	Form *Form `json:"form,omitempty"`

	// An addon containing information about outdated libraries.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.Finding.outdated_library
	OutdatedLibrary *OutdatedLibrary `json:"outdatedLibrary,omitempty"`

	// An addon containing detailed information regarding any resource causing the
	//  vulnerability such as JavaScript sources, image, audio files, etc.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.Finding.violating_resource
	ViolatingResource *ViolatingResource `json:"violatingResource,omitempty"`

	// An addon containing information about vulnerable or missing HTTP headers.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.Finding.vulnerable_headers
	VulnerableHeaders *VulnerableHeaders `json:"vulnerableHeaders,omitempty"`

	// An addon containing information about request parameters which were found
	//  to be vulnerable.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.Finding.vulnerable_parameters
	VulnerableParameters *VulnerableParameters `json:"vulnerableParameters,omitempty"`

	// An addon containing information reported for an XSS, if any.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.Finding.xss
	Xss *Xss `json:"xss,omitempty"`
}

// +kcc:proto=google.cloud.websecurityscanner.v1beta.Form
type Form struct {
	// ! The URI where to send the form when it's submitted.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.Form.action_uri
	ActionURI *string `json:"actionURI,omitempty"`

	// ! The names of form fields related to the vulnerability.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.Form.fields
	Fields []string `json:"fields,omitempty"`
}

// +kcc:proto=google.cloud.websecurityscanner.v1beta.OutdatedLibrary
type OutdatedLibrary struct {
	// The name of the outdated library.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.OutdatedLibrary.library_name
	LibraryName *string `json:"libraryName,omitempty"`

	// The version number.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.OutdatedLibrary.version
	Version *string `json:"version,omitempty"`

	// URLs to learn more information about the vulnerabilities in the library.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.OutdatedLibrary.learn_more_urls
	LearnMoreUrls []string `json:"learnMoreUrls,omitempty"`
}

// +kcc:proto=google.cloud.websecurityscanner.v1beta.ViolatingResource
type ViolatingResource struct {
	// The MIME type of this resource.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.ViolatingResource.content_type
	ContentType *string `json:"contentType,omitempty"`

	// URL of this violating resource.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.ViolatingResource.resource_url
	ResourceURL *string `json:"resourceURL,omitempty"`
}

// +kcc:proto=google.cloud.websecurityscanner.v1beta.VulnerableHeaders
type VulnerableHeaders struct {
	// List of vulnerable headers.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.VulnerableHeaders.headers
	Headers []VulnerableHeaders_Header `json:"headers,omitempty"`

	// List of missing headers.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.VulnerableHeaders.missing_headers
	MissingHeaders []VulnerableHeaders_Header `json:"missingHeaders,omitempty"`
}

// +kcc:proto=google.cloud.websecurityscanner.v1beta.VulnerableHeaders.Header
type VulnerableHeaders_Header struct {
	// Header name.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.VulnerableHeaders.Header.name
	Name *string `json:"name,omitempty"`

	// Header value.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.VulnerableHeaders.Header.value
	Value *string `json:"value,omitempty"`
}

// +kcc:proto=google.cloud.websecurityscanner.v1beta.VulnerableParameters
type VulnerableParameters struct {
	// The vulnerable parameter names.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.VulnerableParameters.parameter_names
	ParameterNames []string `json:"parameterNames,omitempty"`
}

// +kcc:proto=google.cloud.websecurityscanner.v1beta.Xss
type Xss struct {
	// Stack traces leading to the point where the XSS occurred.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.Xss.stack_traces
	StackTraces []string `json:"stackTraces,omitempty"`

	// An error message generated by a javascript breakage.
	// +kcc:proto:field=google.cloud.websecurityscanner.v1beta.Xss.error_message
	ErrorMessage *string `json:"errorMessage,omitempty"`
}
