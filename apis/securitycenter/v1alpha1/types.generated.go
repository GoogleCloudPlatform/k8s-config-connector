// Copyright 2025 Google LLC
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

package v1alpha1


// +kcc:proto=google.cloud.securitycenter.v1.CustomConfig
type CustomConfig struct {
	// The CEL expression to evaluate to produce findings. When the expression
	//  evaluates to true against a resource, a finding is generated.
	// +kcc:proto:field=google.cloud.securitycenter.v1.CustomConfig.predicate
	Predicate *Expr `json:"predicate,omitempty"`

	// Custom output properties.
	// +kcc:proto:field=google.cloud.securitycenter.v1.CustomConfig.custom_output
	CustomOutput *CustomConfig_CustomOutputSpec `json:"customOutput,omitempty"`

	// The resource types that the custom module operates on. Each custom module
	//  can specify up to 5 resource types.
	// +kcc:proto:field=google.cloud.securitycenter.v1.CustomConfig.resource_selector
	ResourceSelector *CustomConfig_ResourceSelector `json:"resourceSelector,omitempty"`

	// The severity to assign to findings generated by the module.
	// +kcc:proto:field=google.cloud.securitycenter.v1.CustomConfig.severity
	Severity *string `json:"severity,omitempty"`

	// Text that describes the vulnerability or misconfiguration that the custom
	//  module detects. This explanation is returned with each finding instance to
	//  help investigators understand the detected issue. The text must be enclosed
	//  in quotation marks.
	// +kcc:proto:field=google.cloud.securitycenter.v1.CustomConfig.description
	Description *string `json:"description,omitempty"`

	// An explanation of the recommended steps that security teams can take to
	//  resolve the detected issue. This explanation is returned with each finding
	//  generated by this module in the `nextSteps` property of the finding JSON.
	// +kcc:proto:field=google.cloud.securitycenter.v1.CustomConfig.recommendation
	Recommendation *string `json:"recommendation,omitempty"`
}

// +kcc:proto=google.cloud.securitycenter.v1.CustomConfig.CustomOutputSpec
type CustomConfig_CustomOutputSpec struct {
	// A list of custom output properties to add to the finding.
	// +kcc:proto:field=google.cloud.securitycenter.v1.CustomConfig.CustomOutputSpec.properties
	Properties []CustomConfig_CustomOutputSpec_Property `json:"properties,omitempty"`
}

// +kcc:proto=google.cloud.securitycenter.v1.CustomConfig.CustomOutputSpec.Property
type CustomConfig_CustomOutputSpec_Property struct {
	// Name of the property for the custom output.
	// +kcc:proto:field=google.cloud.securitycenter.v1.CustomConfig.CustomOutputSpec.Property.name
	Name *string `json:"name,omitempty"`

	// The CEL expression for the custom output. A resource property can be
	//  specified to return the value of the property or a text string enclosed
	//  in quotation marks.
	// +kcc:proto:field=google.cloud.securitycenter.v1.CustomConfig.CustomOutputSpec.Property.value_expression
	ValueExpression *Expr `json:"valueExpression,omitempty"`
}

// +kcc:proto=google.cloud.securitycenter.v1.CustomConfig.ResourceSelector
type CustomConfig_ResourceSelector struct {
	// The resource types to run the detector on.
	// +kcc:proto:field=google.cloud.securitycenter.v1.CustomConfig.ResourceSelector.resource_types
	ResourceTypes []string `json:"resourceTypes,omitempty"`
}

// +kcc:proto=google.cloud.securitycenter.v1.SecurityHealthAnalyticsCustomModule
type SecurityHealthAnalyticsCustomModule struct {
	// Immutable. The resource name of the custom module.
	//  Its format is
	//  "organizations/{organization}/securityHealthAnalyticsSettings/customModules/{customModule}",
	//  or
	//  "folders/{folder}/securityHealthAnalyticsSettings/customModules/{customModule}",
	//  or
	//  "projects/{project}/securityHealthAnalyticsSettings/customModules/{customModule}"
	//
	//  The id {customModule} is server-generated and is not user settable.
	//  It will be a numeric id containing 1-20 digits.
	// +kcc:proto:field=google.cloud.securitycenter.v1.SecurityHealthAnalyticsCustomModule.name
	Name *string `json:"name,omitempty"`

	// The display name of the Security Health Analytics custom module. This
	//  display name becomes the finding category for all findings that are
	//  returned by this custom module. The display name must be between 1 and
	//  128 characters, start with a lowercase letter, and contain alphanumeric
	//  characters or underscores only.
	// +kcc:proto:field=google.cloud.securitycenter.v1.SecurityHealthAnalyticsCustomModule.display_name
	DisplayName *string `json:"displayName,omitempty"`

	// The enablement state of the custom module.
	// +kcc:proto:field=google.cloud.securitycenter.v1.SecurityHealthAnalyticsCustomModule.enablement_state
	EnablementState *string `json:"enablementState,omitempty"`

	// The user specified custom configuration for the module.
	// +kcc:proto:field=google.cloud.securitycenter.v1.SecurityHealthAnalyticsCustomModule.custom_config
	CustomConfig *CustomConfig `json:"customConfig,omitempty"`
}

// +kcc:proto=google.type.Expr
type Expr struct {
	// Textual representation of an expression in Common Expression Language
	//  syntax.
	// +kcc:proto:field=google.type.Expr.expression
	Expression *string `json:"expression,omitempty"`

	// Optional. Title for the expression, i.e. a short string describing
	//  its purpose. This can be used e.g. in UIs which allow to enter the
	//  expression.
	// +kcc:proto:field=google.type.Expr.title
	Title *string `json:"title,omitempty"`

	// Optional. Description of the expression. This is a longer text which
	//  describes the expression, e.g. when hovered over it in a UI.
	// +kcc:proto:field=google.type.Expr.description
	Description *string `json:"description,omitempty"`

	// Optional. String indicating the location of the expression for error
	//  reporting, e.g. a file name and a position in the file.
	// +kcc:proto:field=google.type.Expr.location
	Location *string `json:"location,omitempty"`
}

// +kcc:proto=google.cloud.securitycenter.v1.SecurityHealthAnalyticsCustomModule
type SecurityHealthAnalyticsCustomModuleObservedState struct {
	// Output only. The time at which the custom module was last updated.
	// +kcc:proto:field=google.cloud.securitycenter.v1.SecurityHealthAnalyticsCustomModule.update_time
	UpdateTime *string `json:"updateTime,omitempty"`

	// Output only. The editor that last updated the custom module.
	// +kcc:proto:field=google.cloud.securitycenter.v1.SecurityHealthAnalyticsCustomModule.last_editor
	LastEditor *string `json:"lastEditor,omitempty"`

	// Output only. If empty, indicates that the custom module was created in the
	//  organization, folder, or project in which you are viewing the custom
	//  module. Otherwise, `ancestor_module` specifies the organization or folder
	//  from which the custom module is inherited.
	// +kcc:proto:field=google.cloud.securitycenter.v1.SecurityHealthAnalyticsCustomModule.ancestor_module
	AncestorModule *string `json:"ancestorModule,omitempty"`
}
