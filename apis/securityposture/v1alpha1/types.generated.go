// Copyright 2025 Google LLC
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

package v1alpha1


// +kcc:proto=google.cloud.securityposture.v1.Constraint
type Constraint struct {
	// Optional. SHA built-in detector.
	// +kcc:proto:field=google.cloud.securityposture.v1.Constraint.security_health_analytics_module
	SecurityHealthAnalyticsModule *SecurityHealthAnalyticsModule `json:"securityHealthAnalyticsModule,omitempty"`

	// Optional. SHA custom detector.
	// +kcc:proto:field=google.cloud.securityposture.v1.Constraint.security_health_analytics_custom_module
	SecurityHealthAnalyticsCustomModule *SecurityHealthAnalyticsCustomModule `json:"securityHealthAnalyticsCustomModule,omitempty"`

	// Optional. Org Policy builtin constraint.
	// +kcc:proto:field=google.cloud.securityposture.v1.Constraint.org_policy_constraint
	OrgPolicyConstraint *OrgPolicyConstraint `json:"orgPolicyConstraint,omitempty"`

	// Optional. Org Policy custom constraint.
	// +kcc:proto:field=google.cloud.securityposture.v1.Constraint.org_policy_constraint_custom
	OrgPolicyConstraintCustom *OrgPolicyConstraintCustom `json:"orgPolicyConstraintCustom,omitempty"`
}

// +kcc:proto=google.cloud.securityposture.v1.CustomConfig
type CustomConfig struct {
	// Required. The CEL expression to evaluate to produce findings. When the
	//  expression evaluates to true against a resource, a finding is generated.
	// +kcc:proto:field=google.cloud.securityposture.v1.CustomConfig.predicate
	Predicate *Expr `json:"predicate,omitempty"`

	// Optional. Custom output properties.
	// +kcc:proto:field=google.cloud.securityposture.v1.CustomConfig.custom_output
	CustomOutput *CustomConfig_CustomOutputSpec `json:"customOutput,omitempty"`

	// Required. The resource types that the custom module operates on. Each
	//  custom module can specify up to 5 resource types.
	// +kcc:proto:field=google.cloud.securityposture.v1.CustomConfig.resource_selector
	ResourceSelector *CustomConfig_ResourceSelector `json:"resourceSelector,omitempty"`

	// Required. The severity to assign to findings generated by the module.
	// +kcc:proto:field=google.cloud.securityposture.v1.CustomConfig.severity
	Severity *string `json:"severity,omitempty"`

	// Optional. Text that describes the vulnerability or misconfiguration that
	//  the custom module detects. This explanation is returned with each finding
	//  instance to help investigators understand the detected issue. The text must
	//  be enclosed in quotation marks.
	// +kcc:proto:field=google.cloud.securityposture.v1.CustomConfig.description
	Description *string `json:"description,omitempty"`

	// Optional. An explanation of the recommended steps that security teams can
	//  take to resolve the detected issue. This explanation is returned with each
	//  finding generated by this module in the `nextSteps` property of the finding
	//  JSON.
	// +kcc:proto:field=google.cloud.securityposture.v1.CustomConfig.recommendation
	Recommendation *string `json:"recommendation,omitempty"`
}

// +kcc:proto=google.cloud.securityposture.v1.CustomConfig.CustomOutputSpec
type CustomConfig_CustomOutputSpec struct {
	// Optional. A list of custom output properties to add to the finding.
	// +kcc:proto:field=google.cloud.securityposture.v1.CustomConfig.CustomOutputSpec.properties
	Properties []CustomConfig_CustomOutputSpec_Property `json:"properties,omitempty"`
}

// +kcc:proto=google.cloud.securityposture.v1.CustomConfig.CustomOutputSpec.Property
type CustomConfig_CustomOutputSpec_Property struct {
	// Required. Name of the property for the custom output.
	// +kcc:proto:field=google.cloud.securityposture.v1.CustomConfig.CustomOutputSpec.Property.name
	Name *string `json:"name,omitempty"`

	// Optional. The CEL expression for the custom output. A resource property
	//  can be specified to return the value of the property or a text string
	//  enclosed in quotation marks.
	// +kcc:proto:field=google.cloud.securityposture.v1.CustomConfig.CustomOutputSpec.Property.value_expression
	ValueExpression *Expr `json:"valueExpression,omitempty"`
}

// +kcc:proto=google.cloud.securityposture.v1.CustomConfig.ResourceSelector
type CustomConfig_ResourceSelector struct {
	// Required. The resource types to run the detector on.
	// +kcc:proto:field=google.cloud.securityposture.v1.CustomConfig.ResourceSelector.resource_types
	ResourceTypes []string `json:"resourceTypes,omitempty"`
}

// +kcc:proto=google.cloud.securityposture.v1.CustomConstraint
type CustomConstraint struct {
	// Immutable. Name of the constraint. This is unique within the organization.
	//  Format of the name should be
	//
	//  -
	//  `organizations/{organization_id}/customConstraints/{custom_constraint_id}`
	//
	//  Example: `organizations/123/customConstraints/custom.createOnlyE2TypeVms`
	//
	//  The max length is 70 characters and the minimum length is 1. Note that the
	//  prefix `organizations/{organization_id}/customConstraints/` is not counted.
	// +kcc:proto:field=google.cloud.securityposture.v1.CustomConstraint.name
	Name *string `json:"name,omitempty"`

	// Immutable. The resource instance type on which this policy applies. Format
	//  will be of the form : `<canonical service name>/<type>` Example:
	//
	//   - `compute.googleapis.com/Instance`.
	// +kcc:proto:field=google.cloud.securityposture.v1.CustomConstraint.resource_types
	ResourceTypes []string `json:"resourceTypes,omitempty"`

	// All the operations being applied for this constraint.
	// +kcc:proto:field=google.cloud.securityposture.v1.CustomConstraint.method_types
	MethodTypes []string `json:"methodTypes,omitempty"`

	// Org policy condition/expression. For example:
	//  `resource.instanceName.matches("[production|test]_.*_(\d)+")` or,
	//  `resource.management.auto_upgrade == true`
	//
	//  The max length of the condition is 1000 characters.
	// +kcc:proto:field=google.cloud.securityposture.v1.CustomConstraint.condition
	Condition *string `json:"condition,omitempty"`

	// Allow or deny type.
	// +kcc:proto:field=google.cloud.securityposture.v1.CustomConstraint.action_type
	ActionType *string `json:"actionType,omitempty"`

	// One line display name for the UI.
	//  The max length of the display_name is 200 characters.
	// +kcc:proto:field=google.cloud.securityposture.v1.CustomConstraint.display_name
	DisplayName *string `json:"displayName,omitempty"`

	// Detailed information about this custom policy constraint.
	//  The max length of the description is 2000 characters.
	// +kcc:proto:field=google.cloud.securityposture.v1.CustomConstraint.description
	Description *string `json:"description,omitempty"`
}

// +kcc:proto=google.cloud.securityposture.v1.OrgPolicyConstraint
type OrgPolicyConstraint struct {
	// Required. Org Policy Canned Constraint id.
	// +kcc:proto:field=google.cloud.securityposture.v1.OrgPolicyConstraint.canned_constraint_id
	CannedConstraintID *string `json:"cannedConstraintID,omitempty"`

	// Required. Org PolicySpec rules.
	// +kcc:proto:field=google.cloud.securityposture.v1.OrgPolicyConstraint.policy_rules
	PolicyRules []PolicyRule `json:"policyRules,omitempty"`
}

// +kcc:proto=google.cloud.securityposture.v1.OrgPolicyConstraintCustom
type OrgPolicyConstraintCustom struct {
	// Required. Org Policy Custom Constraint.
	// +kcc:proto:field=google.cloud.securityposture.v1.OrgPolicyConstraintCustom.custom_constraint
	CustomConstraint *CustomConstraint `json:"customConstraint,omitempty"`

	// Required. Org Policyspec rules.
	// +kcc:proto:field=google.cloud.securityposture.v1.OrgPolicyConstraintCustom.policy_rules
	PolicyRules []PolicyRule `json:"policyRules,omitempty"`
}

// +kcc:proto=google.cloud.securityposture.v1.Policy
type Policy struct {
	// Required. ID of the Policy that is user generated, immutable and unique
	//  within the scope of a policy set.
	// +kcc:proto:field=google.cloud.securityposture.v1.Policy.policy_id
	PolicyID *string `json:"policyID,omitempty"`

	// Optional. Contains list of mapping for a Policy to a standard and control.
	// +kcc:proto:field=google.cloud.securityposture.v1.Policy.compliance_standards
	ComplianceStandards []Policy_ComplianceStandard `json:"complianceStandards,omitempty"`

	// Required. Constraint details.
	// +kcc:proto:field=google.cloud.securityposture.v1.Policy.constraint
	Constraint *Constraint `json:"constraint,omitempty"`

	// Optional. Description of the Policy.
	// +kcc:proto:field=google.cloud.securityposture.v1.Policy.description
	Description *string `json:"description,omitempty"`
}

// +kcc:proto=google.cloud.securityposture.v1.Policy.ComplianceStandard
type Policy_ComplianceStandard struct {
	// Optional. The compliance standard that the Policy maps to, e.g.: CIS-2.0.
	// +kcc:proto:field=google.cloud.securityposture.v1.Policy.ComplianceStandard.standard
	Standard *string `json:"standard,omitempty"`

	// Optional. Control mapping provided by user for this Policy. e.g.: 1.5.
	// +kcc:proto:field=google.cloud.securityposture.v1.Policy.ComplianceStandard.control
	Control *string `json:"control,omitempty"`
}

// +kcc:proto=google.cloud.securityposture.v1.PolicyRule
type PolicyRule struct {
	// List of values to be used for this policy rule. This field can be set
	//  only in policies for list constraints.
	// +kcc:proto:field=google.cloud.securityposture.v1.PolicyRule.values
	Values *PolicyRule_StringValues `json:"values,omitempty"`

	// Setting this to true means that all values are allowed. This field can
	//  be set only in policies for list constraints.
	// +kcc:proto:field=google.cloud.securityposture.v1.PolicyRule.allow_all
	AllowAll *bool `json:"allowAll,omitempty"`

	// Setting this to true means that all values are denied. This field can
	//  be set only in policies for list constraints.
	// +kcc:proto:field=google.cloud.securityposture.v1.PolicyRule.deny_all
	DenyAll *bool `json:"denyAll,omitempty"`

	// If `true`, then the policy is enforced. If `false`, then any
	//  configuration is acceptable.
	//  This field can be set only in policies for boolean constraints.
	// +kcc:proto:field=google.cloud.securityposture.v1.PolicyRule.enforce
	Enforce *bool `json:"enforce,omitempty"`

	// A condition which determines whether this rule is used
	//  in the evaluation of the policy. When set, the `expression` field in
	//  the `Expr' must include from 1 to 10 subexpressions, joined by the "||"
	//  or "&&" operators. Each subexpression must be of the form
	//  "resource.matchTag('<ORG_ID>/tag_key_short_name,
	//  'tag_value_short_name')" or "resource.matchTagId('tagKeys/key_id',
	//  'tagValues/value_id')" where key_name and value_name are the resource
	//  names for Label Keys and Values. These names are available from the Tag
	//  Manager Service. An example expression is:
	//  "resource.matchTag('123456789/environment,
	//  'prod')" or "resource.matchTagId('tagKeys/123',
	//  'tagValues/456')".
	// +kcc:proto:field=google.cloud.securityposture.v1.PolicyRule.condition
	Condition *Expr `json:"condition,omitempty"`
}

// +kcc:proto=google.cloud.securityposture.v1.PolicyRule.StringValues
type PolicyRule_StringValues struct {
	// List of values allowed at this resource.
	// +kcc:proto:field=google.cloud.securityposture.v1.PolicyRule.StringValues.allowed_values
	AllowedValues []string `json:"allowedValues,omitempty"`

	// List of values denied at this resource.
	// +kcc:proto:field=google.cloud.securityposture.v1.PolicyRule.StringValues.denied_values
	DeniedValues []string `json:"deniedValues,omitempty"`
}

// +kcc:proto=google.cloud.securityposture.v1.PolicySet
type PolicySet struct {
	// Required. ID of the Policy set.
	// +kcc:proto:field=google.cloud.securityposture.v1.PolicySet.policy_set_id
	PolicySetID *string `json:"policySetID,omitempty"`

	// Optional. Description of the Policy set.
	// +kcc:proto:field=google.cloud.securityposture.v1.PolicySet.description
	Description *string `json:"description,omitempty"`

	// Required. List of policies.
	// +kcc:proto:field=google.cloud.securityposture.v1.PolicySet.policies
	Policies []Policy `json:"policies,omitempty"`
}

// +kcc:proto=google.cloud.securityposture.v1.Posture
type Posture struct {
	// Required. Identifier. The name of this Posture resource, in the format of
	//  organizations/{org_id}/locations/{location_id}/postures/{posture}.
	// +kcc:proto:field=google.cloud.securityposture.v1.Posture.name
	Name *string `json:"name,omitempty"`

	// Required. State of Posture resource.
	// +kcc:proto:field=google.cloud.securityposture.v1.Posture.state
	State *string `json:"state,omitempty"`

	// Optional. User provided description of the posture.
	// +kcc:proto:field=google.cloud.securityposture.v1.Posture.description
	Description *string `json:"description,omitempty"`

	// Required. List of Policy sets.
	// +kcc:proto:field=google.cloud.securityposture.v1.Posture.policy_sets
	PolicySets []PolicySet `json:"policySets,omitempty"`

	// Optional. An opaque tag indicating the current version of the Posture, used
	//  for concurrency control. When the `Posture` is returned from either a
	//  `GetPosture` or a `ListPostures` request, this `etag` indicates the version
	//  of the current `Posture` to use when executing a read-modify-write loop.
	//
	//  When the `Posture` is used in a `UpdatePosture` method, use the `etag`
	//  value that was returned from a `GetPosture` request as part of a
	//  read-modify-write loop for concurrency control. Not setting the `etag` in a
	//  `UpdatePosture` request will result in an unconditional write of the
	//  `Posture`.
	// +kcc:proto:field=google.cloud.securityposture.v1.Posture.etag
	Etag *string `json:"etag,omitempty"`

	// Optional. User annotations. These attributes can only be set and used by
	//  the user, and not by Google Security Postures.
	//  .
	// +kcc:proto:field=google.cloud.securityposture.v1.Posture.annotations
	Annotations map[string]string `json:"annotations,omitempty"`
}

// +kcc:proto=google.cloud.securityposture.v1.SecurityHealthAnalyticsCustomModule
type SecurityHealthAnalyticsCustomModule struct {

	// Optional. The display name of the Security Health Analytics custom module.
	//  This display name becomes the finding category for all findings that are
	//  returned by this custom module. The display name must be between 1 and
	//  128 characters, start with a lowercase letter, and contain alphanumeric
	//  characters or underscores only.
	// +kcc:proto:field=google.cloud.securityposture.v1.SecurityHealthAnalyticsCustomModule.display_name
	DisplayName *string `json:"displayName,omitempty"`

	// Required. custom module details
	// +kcc:proto:field=google.cloud.securityposture.v1.SecurityHealthAnalyticsCustomModule.config
	Config *CustomConfig `json:"config,omitempty"`

	// The state of enablement for the module at its level of the resource
	//  hierarchy.
	// +kcc:proto:field=google.cloud.securityposture.v1.SecurityHealthAnalyticsCustomModule.module_enablement_state
	ModuleEnablementState *string `json:"moduleEnablementState,omitempty"`
}

// +kcc:proto=google.cloud.securityposture.v1.SecurityHealthAnalyticsModule
type SecurityHealthAnalyticsModule struct {
	// Required. The name of the module eg: BIGQUERY_TABLE_CMEK_DISABLED.
	// +kcc:proto:field=google.cloud.securityposture.v1.SecurityHealthAnalyticsModule.module_name
	ModuleName *string `json:"moduleName,omitempty"`

	// The state of enablement for the module at its level of the resource
	//  hierarchy.
	// +kcc:proto:field=google.cloud.securityposture.v1.SecurityHealthAnalyticsModule.module_enablement_state
	ModuleEnablementState *string `json:"moduleEnablementState,omitempty"`
}

// +kcc:proto=google.type.Expr
type Expr struct {
	// Textual representation of an expression in Common Expression Language
	//  syntax.
	// +kcc:proto:field=google.type.Expr.expression
	Expression *string `json:"expression,omitempty"`

	// Optional. Title for the expression, i.e. a short string describing
	//  its purpose. This can be used e.g. in UIs which allow to enter the
	//  expression.
	// +kcc:proto:field=google.type.Expr.title
	Title *string `json:"title,omitempty"`

	// Optional. Description of the expression. This is a longer text which
	//  describes the expression, e.g. when hovered over it in a UI.
	// +kcc:proto:field=google.type.Expr.description
	Description *string `json:"description,omitempty"`

	// Optional. String indicating the location of the expression for error
	//  reporting, e.g. a file name and a position in the file.
	// +kcc:proto:field=google.type.Expr.location
	Location *string `json:"location,omitempty"`
}

// +kcc:proto=google.cloud.securityposture.v1.Constraint
type ConstraintObservedState struct {
	// Optional. SHA custom detector.
	// +kcc:proto:field=google.cloud.securityposture.v1.Constraint.security_health_analytics_custom_module
	SecurityHealthAnalyticsCustomModule *SecurityHealthAnalyticsCustomModuleObservedState `json:"securityHealthAnalyticsCustomModule,omitempty"`

	// Optional. Org Policy custom constraint.
	// +kcc:proto:field=google.cloud.securityposture.v1.Constraint.org_policy_constraint_custom
	OrgPolicyConstraintCustom *OrgPolicyConstraintCustomObservedState `json:"orgPolicyConstraintCustom,omitempty"`
}

// +kcc:proto=google.cloud.securityposture.v1.CustomConstraint
type CustomConstraintObservedState struct {
	// Output only. The last time this custom constraint was updated. This
	//  represents the last time that the `CreateCustomConstraint` or
	//  `UpdateCustomConstraint` RPC was called
	// +kcc:proto:field=google.cloud.securityposture.v1.CustomConstraint.update_time
	UpdateTime *string `json:"updateTime,omitempty"`
}

// +kcc:proto=google.cloud.securityposture.v1.OrgPolicyConstraintCustom
type OrgPolicyConstraintCustomObservedState struct {
	// Required. Org Policy Custom Constraint.
	// +kcc:proto:field=google.cloud.securityposture.v1.OrgPolicyConstraintCustom.custom_constraint
	CustomConstraint *CustomConstraintObservedState `json:"customConstraint,omitempty"`
}

// +kcc:proto=google.cloud.securityposture.v1.Policy
type PolicyObservedState struct {
	// Required. Constraint details.
	// +kcc:proto:field=google.cloud.securityposture.v1.Policy.constraint
	Constraint *ConstraintObservedState `json:"constraint,omitempty"`
}

// +kcc:proto=google.cloud.securityposture.v1.PolicySet
type PolicySetObservedState struct {
	// Required. List of policies.
	// +kcc:proto:field=google.cloud.securityposture.v1.PolicySet.policies
	Policies []PolicyObservedState `json:"policies,omitempty"`
}

// +kcc:proto=google.cloud.securityposture.v1.Posture
type PostureObservedState struct {
	// Output only. Immutable. The revision ID of the posture.
	//  The format is an 8-character hexadecimal string.
	//  https://google.aip.dev/162
	// +kcc:proto:field=google.cloud.securityposture.v1.Posture.revision_id
	RevisionID *string `json:"revisionID,omitempty"`

	// Output only. The timestamp that the posture was created.
	// +kcc:proto:field=google.cloud.securityposture.v1.Posture.create_time
	CreateTime *string `json:"createTime,omitempty"`

	// Output only. The timestamp that the posture was updated.
	// +kcc:proto:field=google.cloud.securityposture.v1.Posture.update_time
	UpdateTime *string `json:"updateTime,omitempty"`

	// Required. List of Policy sets.
	// +kcc:proto:field=google.cloud.securityposture.v1.Posture.policy_sets
	PolicySets []PolicySetObservedState `json:"policySets,omitempty"`

	// Output only. Whether or not this Posture is in the process of being
	//  updated.
	// +kcc:proto:field=google.cloud.securityposture.v1.Posture.reconciling
	Reconciling *bool `json:"reconciling,omitempty"`
}

// +kcc:proto=google.cloud.securityposture.v1.SecurityHealthAnalyticsCustomModule
type SecurityHealthAnalyticsCustomModuleObservedState struct {
	// Output only. Immutable. The id of the custom module.
	//  The id is server-generated and is not user settable.
	//  It will be a numeric id containing 1-20 digits.
	// +kcc:proto:field=google.cloud.securityposture.v1.SecurityHealthAnalyticsCustomModule.id
	ID *string `json:"id,omitempty"`
}
