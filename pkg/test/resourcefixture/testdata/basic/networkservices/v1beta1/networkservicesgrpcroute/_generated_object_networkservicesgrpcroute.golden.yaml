apiVersion: networkservices.cnrm.cloud.google.com/v1beta1
kind: NetworkServicesGRPCRoute
metadata:
  annotations:
    cnrm.cloud.google.com/management-conflict-prevention-policy: none
    cnrm.cloud.google.com/state-into-spec: absent
  finalizers:
  - cnrm.cloud.google.com/finalizer
  - cnrm.cloud.google.com/deletion-defender
  generation: 3
  labels:
    bar: baz
    cnrm-test: "true"
    foo: bar
  name: networkservicesgrpcroute-${uniqueId}
  namespace: ${uniqueId}
spec:
  description: An updated test GrpcRoute
  gateways:
  - name: networkservicesgateway-2-${uniqueId}
  hostnames:
  - test1
  - test2
  - newhost
  location: global
  meshes:
  - name: networkservicesmesh-2-${uniqueId}
  projectRef:
    external: projects/${projectId}
  resourceID: networkservicesgrpcroute-${uniqueId}
  rules:
  - action:
      destinations:
      - serviceRef:
          name: computebackendservice-2-${uniqueId}
        weight: 100
      faultInjectionPolicy:
        abort:
          httpStatus: 502
          percentage: 2
        delay:
          fixedDelay: 11s
          percentage: 3
      retryPolicy:
        numRetries: 4
        retryConditions:
        - refused-stream
      timeout: 40s
    matches:
    - headers:
      - key: bar
        type: REGULAR_EXPRESSION
        value: foo
      method:
        caseSensitive: true
        grpcMethod: SayHello2
        grpcService: helloworld.Greeter2
        type: REGULAR_EXPRESSION
  - action:
      destinations:
      - serviceRef:
          name: computebackendservice-2-${uniqueId}
status:
  conditions:
  - lastTransitionTime: "1970-01-01T00:00:00Z"
    message: The resource is up to date
    reason: UpToDate
    status: "True"
    type: Ready
  createTime: "1970-01-01T00:00:00Z"
  observedGeneration: 3
  selfLink: https://networkservices.googleapis.com/v1alpha1/projects/${projectId}/locations/global/grpcRoutes/networkservicesgrpcroute-${uniqueId}
  updateTime: "1970-01-01T00:00:00Z"
