apiVersion: container.cnrm.cloud.google.com/v1beta1
kind: ContainerCluster
metadata:
  name: containercluster-${uniqueId}
spec:
  location: us-west2
  initialNodeCount: 1
  enableCiliumClusterwideNetworkPolicy: true
  controlPlaneEndpointsConfig:
    dnsEndpointConfig:
      allowExternalTraffic: true
      enableKubernetesTokensViaDNS: true
  enableFqdnNetworkPolicy: true
  datapathProvider: ADVANCED_DATAPATH # Required for Cilium

  gatewayApiConfig:
    channel: "CHANNEL_STANDARD"
  clusterAutoscaling:
    enabled: true
    defaultComputeClassConfig:
      enabled: true
    resourceLimits:
    - resourceType: cpu
      minimum: 1
      maximum: 2
    - resourceType: memory
      minimum: 4
      maximum: 8
    autoProvisioningDefaults:
      management:
        autoUpgrade: true
