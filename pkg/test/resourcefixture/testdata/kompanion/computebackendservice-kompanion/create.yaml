apiVersion: compute.cnrm.cloud.google.com/v1beta1
kind: ComputeBackendService
metadata:
  name: computebackendservice-kompanion-${uniqueId}
spec:
  description: Backend Service for computebackendservice-kompanion-${uniqueId}
  loadBalancingScheme: INTERNAL_MANAGED
  location: global
  protocol: HTTPS
  sessionAffinity: NONE
  timeoutSec: 30
  connectionDrainingTimeoutSec: 0
  portName: http
  backend:
    - balancingMode: UTILIZATION
      group:
        networkEndpointGroupRef:
          name: "computebackendservice-dep1-${uniqueId}"
    - balancingMode: UTILIZATION
      group:
        networkEndpointGroupRef:
          name: "computebackendservice-dep2-${uniqueId}"
  outlierDetection:
    enforcingSuccessRate: 0
    maxEjectionPercent: 50
    successRateMinimumHosts: 0
    successRateRequestVolume: 0
    successRateStdevFactor: 0