// Copyright 2025 Google LLC
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//    http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

// ----------------------------------------------------------------------------
//
//     ***     AUTO GENERATED CODE    ***    AUTO GENERATED CODE     ***
//
// ----------------------------------------------------------------------------
//
//     This file is automatically generated by Config Connector and manual
//     changes will be clobbered when the file is regenerated.
//
// ----------------------------------------------------------------------------

// *** DISCLAIMER ***
// Config Connector's go-client for CRDs is currently in ALPHA, which means
// that future versions of the go-client may include breaking changes.
// Please try it out and give us feedback!

package v1alpha1

import (
	"github.com/GoogleCloudPlatform/k8s-config-connector/pkg/clients/generated/apis/k8s/v1alpha1"
	metav1 "k8s.io/apimachinery/pkg/apis/meta/v1"
)

type NodegroupAccelerators struct {
	/* The number of the accelerator cards of this type exposed to this instance. */
	// +optional
	AcceleratorCount *int32 `json:"acceleratorCount,omitempty"`

	/* Full URL, partial URI, or short name of the accelerator type resource to
	expose to this instance. See
	[Compute Engine
	AcceleratorTypes](https://cloud.google.com/compute/docs/reference/v1/acceleratorTypes).

	Examples:

	* `https://www.googleapis.com/compute/v1/projects/[project_id]/zones/[zone]/acceleratorTypes/nvidia-tesla-t4`
	* `projects/[project_id]/zones/[zone]/acceleratorTypes/nvidia-tesla-t4`
	* `nvidia-tesla-t4`

	**Auto Zone Exception**: If you are using the Dataproc
	[Auto Zone
	Placement](https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/auto-zone#using_auto_zone_placement)
	feature, you must use the short name of the accelerator type
	resource, for example, `nvidia-tesla-t4`. */
	// +optional
	AcceleratorTypeURI *string `json:"acceleratorTypeURI,omitempty"`
}

type NodegroupDiskConfig struct {
	/* Optional. Indicates how many IOPS to provision for the disk. This sets the number of I/O operations per second that the disk can handle. Note: This field is only supported if boot_disk_type is hyperdisk-balanced. */
	// +optional
	BootDiskProvisionedIOPs *int64 `json:"bootDiskProvisionedIOPs,omitempty"`

	/* Optional. Indicates how much throughput to provision for the disk. This sets the number of throughput mb per second that the disk can handle. Values must be greater than or equal to 1. Note: This field is only supported if boot_disk_type is hyperdisk-balanced. */
	// +optional
	BootDiskProvisionedThroughput *int64 `json:"bootDiskProvisionedThroughput,omitempty"`

	/* Optional. Size in GB of the boot disk (default is 500GB). */
	// +optional
	BootDiskSizeGB *int32 `json:"bootDiskSizeGB,omitempty"`

	/* Optional. Type of the boot disk (default is "pd-standard"). Valid values: "pd-balanced" (Persistent Disk Balanced Solid State Drive), "pd-ssd" (Persistent Disk Solid State Drive), or "pd-standard" (Persistent Disk Hard Disk Drive). See [Disk types](https://cloud.google.com/compute/docs/disks#disk-types). */
	// +optional
	BootDiskType *string `json:"bootDiskType,omitempty"`

	/* Optional. Interface type of local SSDs (default is "scsi"). Valid values: "scsi" (Small Computer System Interface), "nvme" (Non-Volatile Memory Express). See [local SSD performance](https://cloud.google.com/compute/docs/disks/local-ssd#performance). */
	// +optional
	LocalSSDInterface *string `json:"localSSDInterface,omitempty"`

	/* Optional. Number of attached SSDs, from 0 to 8 (default is 0).
	If SSDs are not attached, the boot disk is used to store runtime logs and
	[HDFS](https://hadoop.apache.org/docs/r1.2.1/hdfs_user_guide.html) data.
	If one or more SSDs are attached, this runtime bulk
	data is spread across them, and the boot disk contains only basic
	config and installed binaries.

	Note: Local SSD options may vary by machine type and number of vCPUs
	selected. */
	// +optional
	NumLocalSSDs *int32 `json:"numLocalSSDs,omitempty"`
}

type NodegroupInstanceFlexibilityPolicy struct {
	/* Optional. List of instance selection options that the group will use when creating new VMs. */
	// +optional
	InstanceSelectionList []NodegroupInstanceSelectionList `json:"instanceSelectionList,omitempty"`

	/* Optional. Defines how the Group selects the provisioning model to ensure required reliability. */
	// +optional
	ProvisioningModelMix *NodegroupProvisioningModelMix `json:"provisioningModelMix,omitempty"`
}

type NodegroupInstanceSelectionList struct {
	/* Optional. Full machine-type names, e.g. "n1-standard-16". */
	// +optional
	MachineTypes []string `json:"machineTypes,omitempty"`

	/* Optional. Preference of this instance selection. Lower number means higher preference. Dataproc will first try to create a VM based on the machine-type with priority rank and fallback to next rank based on availability. Machine types and instance selections with the same priority have the same preference. */
	// +optional
	Rank *int32 `json:"rank,omitempty"`
}

type NodegroupNodeGroupConfig struct {
	/* Optional. The Compute Engine accelerator configuration for these instances. */
	// +optional
	Accelerators []NodegroupAccelerators `json:"accelerators,omitempty"`

	/* Optional. Disk option config settings. */
	// +optional
	DiskConfig *NodegroupDiskConfig `json:"diskConfig,omitempty"`

	/* Optional. The Compute Engine image resource used for cluster instances.

	The URI can represent an image or image family.

	Image examples:

	* `https://www.googleapis.com/compute/v1/projects/[project_id]/global/images/[image-id]`
	* `projects/[project_id]/global/images/[image-id]`
	* `image-id`

	Image family examples. Dataproc will use the most recent
	image from the family:

	* `https://www.googleapis.com/compute/v1/projects/[project_id]/global/images/family/[custom-image-family-name]`
	* `projects/[project_id]/global/images/family/[custom-image-family-name]`

	If the URI is unspecified, it will be inferred from
	`SoftwareConfig.image_version` or the system default. */
	// +optional
	ImageURI *string `json:"imageURI,omitempty"`

	/* Optional. Instance flexibility Policy allowing a mixture of VM shapes and provisioning models. */
	// +optional
	InstanceFlexibilityPolicy *NodegroupInstanceFlexibilityPolicy `json:"instanceFlexibilityPolicy,omitempty"`

	/* Optional. The Compute Engine machine type used for cluster instances.

	A full URL, partial URI, or short name are valid. Examples:

	* `https://www.googleapis.com/compute/v1/projects/[project_id]/zones/[zone]/machineTypes/n1-standard-2`
	* `projects/[project_id]/zones/[zone]/machineTypes/n1-standard-2`
	* `n1-standard-2`

	**Auto Zone Exception**: If you are using the Dataproc
	[Auto Zone
	Placement](https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/auto-zone#using_auto_zone_placement)
	feature, you must use the short name of the machine type
	resource, for example, `n1-standard-2`. */
	// +optional
	MachineTypeURI *string `json:"machineTypeURI,omitempty"`

	/* Optional. Specifies the minimum cpu platform for the Instance Group. See [Dataproc -> Minimum CPU Platform](https://cloud.google.com/dataproc/docs/concepts/compute/dataproc-min-cpu). */
	// +optional
	MinCPUPlatform *string `json:"minCPUPlatform,omitempty"`

	/* Optional. The minimum number of primary worker instances to create.
	If `min_num_instances` is set, cluster creation will succeed if
	the number of primary workers created is at least equal to the
	`min_num_instances` number.

	Example: Cluster creation request with `num_instances` = `5` and
	`min_num_instances` = `3`:

	*  If 4 VMs are created and 1 instance fails,
	the failed VM is deleted. The cluster is
	resized to 4 instances and placed in a `RUNNING` state.
	*  If 2 instances are created and 3 instances fail,
	the cluster in placed in an `ERROR` state. The failed VMs
	are not deleted. */
	// +optional
	MinNumInstances *int32 `json:"minNumInstances,omitempty"`

	/* Optional. The number of VM instances in the instance group. For [HA cluster](/dataproc/docs/concepts/configuring-clusters/high-availability) [master_config](#FIELDS.master_config) groups, **must be set to 3**. For standard cluster [master_config](#FIELDS.master_config) groups, **must be set to 1**. */
	// +optional
	NumInstances *int32 `json:"numInstances,omitempty"`

	/* Optional. Specifies the preemptibility of the instance group.

	The default value for master and worker groups is
	`NON_PREEMPTIBLE`. This default cannot be changed.

	The default value for secondary instances is
	`PREEMPTIBLE`. */
	// +optional
	Preemptibility *string `json:"preemptibility,omitempty"`

	/* Optional. Configuration to handle the startup of instances during cluster create and update process. */
	// +optional
	StartupConfig *NodegroupStartupConfig `json:"startupConfig,omitempty"`
}

type NodegroupProvisioningModelMix struct {
	/* Optional. The base capacity that will always use Standard VMs to avoid risk of more preemption than the minimum capacity you need. Dataproc will create only standard VMs until it reaches standard_capacity_base, then it will start using standard_capacity_percent_above_base to mix Spot with Standard VMs. eg. If 15 instances are requested and standard_capacity_base is 5, Dataproc will create 5 standard VMs and then start mixing spot and standard VMs for remaining 10 instances. */
	// +optional
	StandardCapacityBase *int32 `json:"standardCapacityBase,omitempty"`

	/* Optional. The percentage of target capacity that should use Standard VM. The remaining percentage will use Spot VMs. The percentage applies only to the capacity above standard_capacity_base. eg. If 15 instances are requested and standard_capacity_base is 5 and standard_capacity_percent_above_base is 30, Dataproc will create 5 standard VMs and then start mixing spot and standard VMs for remaining 10 instances. The mix will be 30% standard and 70% spot. */
	// +optional
	StandardCapacityPercentAboveBase *int32 `json:"standardCapacityPercentAboveBase,omitempty"`
}

type NodegroupStartupConfig struct {
	/* Optional. The config setting to enable cluster creation/ updation to be successful only after required_registration_fraction of instances are up and running. This configuration is applicable to only secondary workers for now. The cluster will fail if required_registration_fraction of instances are not available. This will include instance creation, agent registration, and service registration (if enabled). */
	// +optional
	RequiredRegistrationFraction *float64 `json:"requiredRegistrationFraction,omitempty"`
}

type DataprocNodeGroupSpec struct {
	/* Optional. Node group labels.

	* Label **keys** must consist of from 1 to 63 characters and conform to
	[RFC 1035](https://www.ietf.org/rfc/rfc1035.txt).
	* Label **values** can be empty. If specified, they must consist of from
	1 to 63 characters and conform to [RFC 1035]
	(https://www.ietf.org/rfc/rfc1035.txt).
	* The node group must have no more than 32 labels. */
	// +optional
	Labels map[string]string `json:"labels,omitempty"`

	/* Required. */
	// +optional
	Location *string `json:"location,omitempty"`

	/* Optional. The node group instance group configuration. */
	// +optional
	NodeGroupConfig *NodegroupNodeGroupConfig `json:"nodeGroupConfig,omitempty"`

	/* Required. */
	// +optional
	ProjectRef *v1alpha1.ResourceRef `json:"projectRef,omitempty"`

	/* The DataprocNodeGroup name. If not given, the metadata.name will be used. */
	// +optional
	ResourceID *string `json:"resourceID,omitempty"`

	/* Required. Node group roles. */
	// +optional
	Roles []string `json:"roles,omitempty"`
}

type NodegroupInstanceFlexibilityPolicyStatus struct {
	/* Output only. A list of instance selection results in the group. */
	// +optional
	InstanceSelectionResults []NodegroupInstanceSelectionResultsStatus `json:"instanceSelectionResults,omitempty"`
}

type NodegroupInstanceReferencesStatus struct {
	/* The unique identifier of the Compute Engine instance. */
	// +optional
	InstanceID *string `json:"instanceID,omitempty"`

	/* The user-friendly name of the Compute Engine instance. */
	// +optional
	InstanceName *string `json:"instanceName,omitempty"`

	/* The public ECIES key used for sharing data with this instance. */
	// +optional
	PublicEciesKey *string `json:"publicEciesKey,omitempty"`

	/* The public RSA key used for sharing data with this instance. */
	// +optional
	PublicKey *string `json:"publicKey,omitempty"`
}

type NodegroupInstanceSelectionResultsStatus struct {
}

type NodegroupManagedGroupConfigStatus struct {
}

type NodegroupNodeGroupConfigStatus struct {
	/* Optional. Instance flexibility Policy allowing a mixture of VM shapes and provisioning models. */
	// +optional
	InstanceFlexibilityPolicy *NodegroupInstanceFlexibilityPolicyStatus `json:"instanceFlexibilityPolicy,omitempty"`

	/* Output only. The list of instance names. Dataproc derives the names from `cluster_name`, `num_instances`, and the instance group. */
	// +optional
	InstanceNames []string `json:"instanceNames,omitempty"`

	/* Output only. List of references to Compute Engine instances. */
	// +optional
	InstanceReferences []NodegroupInstanceReferencesStatus `json:"instanceReferences,omitempty"`

	/* Output only. Specifies that this instance group contains preemptible instances. */
	// +optional
	IsPreemptible *bool `json:"isPreemptible,omitempty"`

	/* Output only. The config for Compute Engine Instance Group Manager that manages this group. This is only used for preemptible instance groups. */
	// +optional
	ManagedGroupConfig *NodegroupManagedGroupConfigStatus `json:"managedGroupConfig,omitempty"`
}

type NodegroupObservedStateStatus struct {
	/* Optional. The node group instance group configuration. */
	// +optional
	NodeGroupConfig *NodegroupNodeGroupConfigStatus `json:"nodeGroupConfig,omitempty"`
}

type DataprocNodeGroupStatus struct {
	/* Conditions represent the latest available observations of the
	   DataprocNodeGroup's current state. */
	Conditions []v1alpha1.Condition `json:"conditions,omitempty"`
	/* A unique specifier for the DataprocNodeGroup resource in GCP. */
	// +optional
	ExternalRef *string `json:"externalRef,omitempty"`

	/* ObservedGeneration is the generation of the resource that was most recently observed by the Config Connector controller. If this is equal to metadata.generation, then that means that the current reported status reflects the most recent desired state of the resource. */
	// +optional
	ObservedGeneration *int64 `json:"observedGeneration,omitempty"`

	/* ObservedState is the state of the resource as most recently observed in GCP. */
	// +optional
	ObservedState *NodegroupObservedStateStatus `json:"observedState,omitempty"`
}

// +genclient
// +k8s:deepcopy-gen:interfaces=k8s.io/apimachinery/pkg/runtime.Object
// +kubebuilder:resource:categories=gcp,shortName=gcpdataprocnodegroup;gcpdataprocnodegroups
// +kubebuilder:subresource:status
// +kubebuilder:metadata:labels="cnrm.cloud.google.com/managed-by-kcc=true";"cnrm.cloud.google.com/system=true"
// +kubebuilder:printcolumn:name="Age",JSONPath=".metadata.creationTimestamp",type="date"
// +kubebuilder:printcolumn:name="Ready",JSONPath=".status.conditions[?(@.type=='Ready')].status",type="string",description="When 'True', the most recent reconcile of the resource succeeded"
// +kubebuilder:printcolumn:name="Status",JSONPath=".status.conditions[?(@.type=='Ready')].reason",type="string",description="The reason for the value in 'Ready'"
// +kubebuilder:printcolumn:name="Status Age",JSONPath=".status.conditions[?(@.type=='Ready')].lastTransitionTime",type="date",description="The last transition time for the value in 'Status'"

// DataprocNodeGroup is the Schema for the dataproc API
// +k8s:openapi-gen=true
type DataprocNodeGroup struct {
	metav1.TypeMeta   `json:",inline"`
	metav1.ObjectMeta `json:"metadata,omitempty"`

	Spec   DataprocNodeGroupSpec   `json:"spec,omitempty"`
	Status DataprocNodeGroupStatus `json:"status,omitempty"`
}

// +k8s:deepcopy-gen:interfaces=k8s.io/apimachinery/pkg/runtime.Object

// DataprocNodeGroupList contains a list of DataprocNodeGroup
type DataprocNodeGroupList struct {
	metav1.TypeMeta `json:",inline"`
	metav1.ListMeta `json:"metadata,omitempty"`
	Items           []DataprocNodeGroup `json:"items"`
}

func init() {
	SchemeBuilder.Register(&DataprocNodeGroup{}, &DataprocNodeGroupList{})
}
