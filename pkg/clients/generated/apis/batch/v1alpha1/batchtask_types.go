// Copyright 2020 Google LLC
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//    http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

// ----------------------------------------------------------------------------
//
//     ***     AUTO GENERATED CODE    ***    AUTO GENERATED CODE     ***
//
// ----------------------------------------------------------------------------
//
//     This file is automatically generated by Config Connector and manual
//     changes will be clobbered when the file is regenerated.
//
// ----------------------------------------------------------------------------

// *** DISCLAIMER ***
// Config Connector's go-client for CRDs is currently in ALPHA, which means
// that future versions of the go-client may include breaking changes.
// Please try it out and give us feedback!

package v1alpha1

import (
	"github.com/GoogleCloudPlatform/k8s-config-connector/pkg/clients/generated/apis/k8s/v1alpha1"
	metav1 "k8s.io/apimachinery/pkg/apis/meta/v1"
)

type BatchTaskSpec struct {
	/* Immutable. The location where the alloydb cluster should reside. */
	Location string `json:"location"`

	/* The project that this resource belongs to. */
	ProjectRef v1alpha1.ResourceRef `json:"projectRef"`

	/* The BatchTask name. If not given, the metadata.name will be used. */
	// +optional
	ResourceID *string `json:"resourceID,omitempty"`
}

type TaskObservedStateStatus struct {
	/* Task Status. */
	// +optional
	Status *TaskStatusStatus `json:"status,omitempty"`
}

type TaskStatusEventsStatus struct {
	/* Description of the event. */
	// +optional
	Description *string `json:"description,omitempty"`

	/* The time this event occurred. */
	// +optional
	EventTime *string `json:"eventTime,omitempty"`

	/* Task Execution. This field is only defined for task-level status events where the task fails. */
	// +optional
	TaskExecution *TaskTaskExecutionStatus `json:"taskExecution,omitempty"`

	/* Task State. This field is only defined for task-level status events. */
	// +optional
	TaskState *string `json:"taskState,omitempty"`

	/* Type of the event. */
	// +optional
	Type *string `json:"type,omitempty"`
}

type TaskStatusStatus struct {
	/* Task state. */
	// +optional
	State *string `json:"state,omitempty"`

	/* Detailed info about why the state is reached. */
	// +optional
	StatusEvents []TaskStatusEventsStatus `json:"statusEvents,omitempty"`
}

type TaskTaskExecutionStatus struct {
	/* The exit code of a finished task.

	If the task succeeded, the exit code will be 0. If the task failed but not
	due to the following reasons, the exit code will be 50000.

	Otherwise, it can be from different sources:
	* Batch known failures:
	https://cloud.google.com/batch/docs/troubleshooting#reserved-exit-codes.
	* Batch runnable execution failures; you can rely on Batch logs to further
	diagnose: https://cloud.google.com/batch/docs/analyze-job-using-logs. If
	there are multiple runnables failures, Batch only exposes the first error. */
	// +optional
	ExitCode *int32 `json:"exitCode,omitempty"`
}

type BatchTaskStatus struct {
	/* Conditions represent the latest available observations of the
	   BatchTask's current state. */
	Conditions []v1alpha1.Condition `json:"conditions,omitempty"`
	/* A unique specifier for the BatchTask resource in GCP. */
	// +optional
	ExternalRef *string `json:"externalRef,omitempty"`

	/* Task name. The name is generated from the parent TaskGroup name and 'id' field. For example: "projects/123456/locations/us-west1/jobs/job01/taskGroups/group01/tasks/task01". */
	// +optional
	Name *string `json:"name,omitempty"`

	/* ObservedGeneration is the generation of the resource that was most recently observed by the Config Connector controller. If this is equal to metadata.generation, then that means that the current reported status reflects the most recent desired state of the resource. */
	// +optional
	ObservedGeneration *int64 `json:"observedGeneration,omitempty"`

	/* BatchTaskObservedState is the state of the BatchTask resource as most recently observed in GCP. */
	// +optional
	ObservedState *TaskObservedStateStatus `json:"observedState,omitempty"`
}

// +genclient
// +k8s:deepcopy-gen:interfaces=k8s.io/apimachinery/pkg/runtime.Object
// +kubebuilder:resource:categories=gcp,shortName=gcpbatchtask;gcpbatchtasks
// +kubebuilder:subresource:status
// +kubebuilder:metadata:labels="cnrm.cloud.google.com/managed-by-kcc=true"
// +kubebuilder:metadata:labels="cnrm.cloud.google.com/system=true"
// +kubebuilder:printcolumn:name="Age",JSONPath=".metadata.creationTimestamp",type="date"
// +kubebuilder:printcolumn:name="Ready",JSONPath=".status.conditions[?(@.type=='Ready')].status",type="string",description="When 'True', the most recent reconcile of the resource succeeded"
// +kubebuilder:printcolumn:name="Status",JSONPath=".status.conditions[?(@.type=='Ready')].reason",type="string",description="The reason for the value in 'Ready'"
// +kubebuilder:printcolumn:name="Status Age",JSONPath=".status.conditions[?(@.type=='Ready')].lastTransitionTime",type="date",description="The last transition time for the value in 'Status'"

// BatchTask is the Schema for the batch API
// +k8s:openapi-gen=true
type BatchTask struct {
	metav1.TypeMeta   `json:",inline"`
	metav1.ObjectMeta `json:"metadata,omitempty"`

	Spec   BatchTaskSpec   `json:"spec,omitempty"`
	Status BatchTaskStatus `json:"status,omitempty"`
}

// +k8s:deepcopy-gen:interfaces=k8s.io/apimachinery/pkg/runtime.Object

// BatchTaskList contains a list of BatchTask
type BatchTaskList struct {
	metav1.TypeMeta `json:",inline"`
	metav1.ListMeta `json:"metadata,omitempty"`
	Items           []BatchTask `json:"items"`
}

func init() {
	SchemeBuilder.Register(&BatchTask{}, &BatchTaskList{})
}
